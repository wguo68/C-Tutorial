
[教小白精通编程](http://xuepro.xcguan.net)

系列课程之

##  现代c++11/14/17教程之4--运算符与表达式2

 严禁未经作者同意，转载请注明出处，否则将追究法律责任！

## 2. 位运算

任何量在计算机内存里都是用一串二进制位表示的，假如有2个数A = 37和B = 22是用1个字节，即8位表示的,其内存的二进制位如下所示：

```
   A = 0 0 1 0 0 1 0 1
   B = 0 0 0 1 0 1 1 0
```
位运算运算符“位与运算”&，对A,B运算的结果如下
```
 A&B = 0 0 0 0 0 1 0 0
```
“位与运算”&实际是对A和B的对应二进制位进行相应的运算。
假设p是A的某个二进制位，q是B的某个二进制位，只有p和q都是1时，p&q的结果才是1，否则都是0。

| p  | q  | p&q | 
|:--:|:--:|:---:|
| 0  | 0  |  0  |
| 0  | 1  |  0  |
| 1  | 0  |  0  |
| 1  | 1  |  1  |

基本的位操作符有与'&'、或'|'、异或'^'、取反'~'、左移'<<'、右移'>>'这6种.它们的运算规则如下:

|运算符|中文名|                 运算规则                | 
|:----:|:----:|:---------------------------------------:|
|   &  |  与  |2个位都是1时，结果才是1                  |
|   #124;  |  或  |2个位都是0时，结果才是0                  |
|   ^  |  与  |2个位相同结果为0，相异为0                |
|   ~  | 取反 |一元运算符，0变为1，1变为0               |
|  <<  | 左移 |各二进位全部左移若干位，高位丢弃，低位补0|
|  >>  | 右移 |各二进位全部左移若干位，无符号数，高位补0|

右移运算符对有符号数的补位，不同编译器处理不同，略。

下表是&、|、^这3个二元运算符的运算规则：

| p  | q  | p&q | p&#124;q | p^q |  
|:--:|:--:|:---:|:---:|:---:|
| 0  | 0  |  0  |  0  |  0  |
| 0  | 1  |  0  |  1  |  1  |
| 1  | 0  |  0  |  1  |  1  |
| 1  | 1  |  1  |  1  |  0  |

因此
```
   A = 0 0 1 0 0 1 0 1
   B = 0 0 0 1 0 1 1 0
 A&B = 0 0 0 0 0 1 0 0
 A|B = 0 0 1 1 0 1 1 1
 A^B = 0 0 1 1 0 0 1 1
 B<<2= 0 1 0 1 1 0 0 0
 ~B  = 1 1 1 0 1 0 0 1 
```

## 3. 赋值运算符
最基本的赋值运算符是：'='。如"a=b"就是将b的值赋值给变量a，即拷贝到变量a的内存块中。基本赋值运算符'='和算术运算符或位运算符组合构成了符合赋值运算符，如赋值运算符"+="的运算"a+=b"就相当于 "a = a+b"，即将b的值加到a上去。
如下表是各种赋值运算符

|运算符|  例子|         含义              | 
|:----:|:----:|:-------------------------:|
|   =  | a=b  |将b的值赋值给变量a         |
|  +=  | a+=b |相当于 "a = a+b"           |
|  -=  | a-=b |相当于 "a = a-b"           | 
|  *=  | a*=b |相当于 "a = a*b"           |
|  /=  | a/=b |相当于 "a = a/b"           |
|  %=  | a%=b |相当于 "a = a%b"           |
|  &=  | a&=b |相当于 "a = a&b"           |
|  &#124;=  | a&#124;=b |相当于 "a = a&#124;b"           | 
|  ^=  | a^=b |相当于 "a = a^b"           |
| <<=  |a<<=2 |相当于 "a = a<<2"          |
| >>=  |a>>=2 |相当于 "a = a>>2"          |

关于赋值运算符的几个说明

* 右结合性,赋值运算符“从右到左”次序计算。如"a=b=c"是先计算"b=c"，然后"a=b"。

* 多个赋值运算符连用时，类型必须一致。

* 赋值运算符的左边必须是一个左值(可修改的具有独立内存的变量).不能是文字量或常量,也不能是表达式。如
"34=a"或"a+b=c"都是错误的！


## 4. 关系运算符

比较两个量是否相等“==”或不等“!=”，比较两个量是否小于"<"或小于等于"<="。

比较的结果是一个bool类型的值"true"或"false"。

|运算符|  例子 |                 含义              | 
|:----:|:-----:|:---------------------------------:|
|  ==  | a==b   |a,b相等时，返回true，否则false    |
|  !=  | a!=b   |a,b不等时，返回true，否则false    |
|  <   | a < b  |a小于b时， 返回true，否则false    |
|  <=  | a <= b |a小于等于b时，返回true，否则false |
|   >  | a > b  |a大于于b时， 返回true，否则false  |
|  >=  | a >= b |a大于等于b时，返回true，否则false |

我们看一个具体的程序例子
```cpp
#include <iostream>
using namespace std; //引入整个名字空间，cout前就不需要再加std::了
int main(){
   int a = 4,b = 5;
   bool b1 = a<b;  // bool b1 = (a<b) 
   bool b2 = a==b; // bool b2 = (a==b) 
   //boolalpha使得后面的bool变量输出"true"或"false"而不是1或0
   cout << boolalpha     
        << b1 << endl
        << b2 << endl;
}

```

注意：对于2个浮点数，不能用"=="判断它们是否相等，如下列程序
```cpp
#include <iostream>
using namespace std;
int main(){
   double d1(100-99.99);
   double d2(10-9.99);
   bool b = d1==d2; // bool b = (d1==d2)
   cout << boolalpha  << b << endl;
}
```
输出结果将是"false"，尽管理论上d1和d2都应该是0.01，但由于计算机不能精确表示浮点数(只能近似)，实际上d1和d2在计算机内部的表示还是有误差的。

```cpp
#include <iostream>
using namespace std;
int main(){
   double d1(100-99.99);
   double d2(10-9.99);
   bool b = d1==d2; // bool b = (d1==d2)
   cout << boolalpha  << b << endl;
   cout<<precison(17); //浮点数输出格式修改为精度17位
   cout<<d1<<endl;
   cout<<d2<<endl;
}
```
因此判断2个浮点数是否相等，通常是看它们差的绝对值是否足够小。如：
```cpp
#include <iostream>
#include<cmath> //fabs函数在cmath头文件中
using namespace std;
int main(){
   double d1(100-99.99);
   double d2(10-9.99);
   bool b = fabs(d1-d2)<1e-10; // 误差是否足够小？
   cout << boolalpha  << b << endl;
   cout<<precison(17); 
   cout<<d1<<endl;
   cout<<d2<<endl;
}
```

## 5. 逻辑运算符

有&&、||、!3种逻辑运算符，对bool类型的量进行运算。


|运算符|中文名|                 运算规则                | 
|:----:|:----:|:---------------------------------------:|
|  &&  |  与  |2个都是true时，结果才为true              |
|  ||  |  或  |有1个是true时，结果就为true              |
|   !  |  非  |一元运算符,true变为false,false变为true   |



**[练习]**: 



关注微博"[教小白精通编程](https://weibo.com/6196175626/profile?topnav=1&wvr=6)".  加入QQ群：101132160 ​​​ 享受直接的辅导！